<div class="mat-tab-g">
  <mat-tab-group style="padding-bottom: 1% !important;background-color: #ffffff;border-radius: 20px;" class="tab-group" mat-stretch-tabs="false" mat-align-tabs="start" (selectedTabChange)="onTabSelectionChange($event)">
  <mat-tab label="FCFE" *ngIf = "fcfe">
    <div style="display: flex; align-items: center; justify-content: space-between;padding: 1%;">
      <div style="display: flex; align-items: center;width: 85%;">
        <div style="display: inline-block; align-items: center;" [ngStyle]="getStyle('terminalWorkingContainer')">
          <input type="radio" id="tvCashFlow" name="radios" style="vertical-align: text-top;" [checked]="terminalValueSelectedType === 'tvCashFlowBased'" (click)="terminalValueOptions('tvCashFlowBased')">
          <label for="tvCashFlow" class="remove-bottom-margin terminal-working-options" style="padding-right: 4%;">
            Terminal Value based on last year Cash Flow
            <span class="tool-class" style="vertical-align: sub;">
              <svg [matTooltip]="helperText.tvCashFlowBased" matTooltipPosition="above" matTooltipClass='model-tooltip' xmlns="http://www.w3.org/2000/svg" width="17" height="17" viewBox="0 0 512 512">
                <path d="M248,64C146.39,64,64,146.39,64,248s82.39,184,184,184,184-82.39,184-184S349.61,64,248,64Z" class="path-svg" style="fill:none;stroke:#3355dd;stroke-miterlimit:10;stroke-width:37px" 
                fill="#ff0000"></path>
                <polyline points="220 220 252 220 252 336" class="model-polyline" style="fill:none;stroke:#3355dd;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px">
                </polyline><line x1="208" y1="340" x2="296" y2="340" style="fill:none;stroke:#3355dd;stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px">
              </line><path d="M248,130a26,26,0,1,0,26,26A26,26,0,0,0,248,130Z" fill="#ff0000"></path></svg>
            </span>
          </label>
          <input type="radio" id="tvLastYearPat" name="radios" style="vertical-align: text-top;" [checked]="terminalValueSelectedType === 'tvPatBased'" (click)="terminalValueOptions('tvPatBased')">
          <label for="tvLastYearPat" class="remove-bottom-margin terminal-working-options">
            Terminal Value based on last year PAT
            <span class="tool-class" style="vertical-align: sub;">
              <svg [matTooltip]="helperText.tvPatBased" matTooltipPosition="above" matTooltipClass='model-tooltip' xmlns="http://www.w3.org/2000/svg" width="17" height="17" viewBox="0 0 512 512">
                <path d="M248,64C146.39,64,64,146.39,64,248s82.39,184,184,184,184-82.39,184-184S349.61,64,248,64Z" class="path-svg" style="fill:none;stroke:#3355dd;stroke-miterlimit:10;stroke-width:37px" 
                fill="#ff0000"></path>
                <polyline points="220 220 252 220 252 336" class="model-polyline" style="fill:none;stroke:#3355dd;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px">
                </polyline><line x1="208" y1="340" x2="296" y2="340" style="fill:none;stroke:#3355dd;stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px">
              </line><path d="M248,130a26,26,0,1,0,26,26A26,26,0,0,0,248,130Z" fill="#ff0000"></path></svg>
            </span>
          </label>
        </div>
        <button mat-stroked-button class="terminal-working-button" style="color: white;" [ngStyle]="getStyle('terminalWorkingButton')" (click)="loadTerminalValueWorking()">
         View Terminal Working
        </button>
      </div> 
      <button mat-stroked-button class="terminal-working-button" style="width: 17%;color: white;margin-right: 2%;" (click)="sensitivityAnalysis('FCFE')" *ngIf="userAccess">
       Sensitivity Analysis
      </button>
      <div class="dropdown">
        <button [matMenuTriggerFor]="fcfeMenu" class="dropdown-toggle" #trigger="matMenuTrigger" (mouseenter)="trigger.openMenu()" mat-stroked-button>
          Export
        </button>
          <mat-menu  #fcfeMenu="matMenu" xPosition="before">
              <button mat-menu-item class="action-button" [matMenuTriggerFor]="exportSingleOptions">
                <span style="width: 190px;display: block;text-align: left;padding-left: 9%;" class="resume-label">
                  <img style="height: 13px;width: 13px;cursor: pointer;" src="../../../../../../assets/images/icons/sheet.png" alt="">
                <span style="font-size: 14px;padding-left: 9%;font-family: 'AR One Sans', sans-serif !important;">Export Current</span>
              </span>
              </button>
              <button mat-menu-item class="action-button" [matMenuTriggerFor]="exportAllOptions" *ngIf="transferStepperthree?.formOneAndThreeData?.model?.length > 1">
                <span style="width: 190px;display: block;text-align: left;padding-left: 9%;" class="download-label">
                  <img style="height: 13px;width: 13px;cursor: pointer;" src="../../../../../../assets/images/icons/document.png" alt="">
                <span style="font-size: 14px;padding-left: 9%;font-family: 'AR One Sans', sans-serif !important;">Export All</span>
              </span>
              </button>
          </mat-menu>

        <mat-menu #exportAllOptions="matMenu" xPosition="before">
          <button mat-menu-item class="action-button" (click) = "exportValuation(transferStepperthree?.formOneAndThreeData?.company, 'pdf', 'FCFE', (transferStepperthree?.formFourData?.appData?.reportId || null), false)">
            <span style="width: 160px;display: block;text-align: left;padding-left: 9%;" class="resume-label">
              <img style="height: 13px;width: 13px;cursor: pointer;" src="../../../../../../assets/images/icons/pdf.png" alt="">
            <span style="font-size: 14px;padding-left: 9%;font-family: 'AR One Sans', sans-serif !important;">Export as PDF</span>
          </span>
          </button>
          <button mat-menu-item class="action-button" (click) = "exportValuation(transferStepperthree?.formOneAndThreeData?.company, 'docx', 'FCFE', (transferStepperthree?.formFourData?.appData?.reportId || null), false)">
            <span style="width: 160px;display: block;text-align: left;padding-left: 9%;" class="resume-label">
              <img style="height: 13px;width: 13px;cursor: pointer;" src="../../../../../../assets/images/icons/doc.png" alt="">
            <span style="font-size: 14px;padding-left: 9%;font-family: 'AR One Sans', sans-serif !important;">Export as Docx</span>
          </span>
          </button>
          <button mat-menu-item class="action-button" (click) = "exportValuation(transferStepperthree?.formOneAndThreeData?.company, 'xlsx', 'FCFE', (transferStepperthree?.formFourData?.appData?.reportId || null), false)">
            <span style="width: 160px;display: block;text-align: left;padding-left: 9%;" class="download-label">
              <img style="height: 13px;width: 13px;cursor: pointer;" src="../../../../../../assets/images/icons/xls.png" alt="">
            <span style="font-size: 14px;padding-left: 9%;font-family: 'AR One Sans', sans-serif !important;">Export as Excel</span>
          </span>
          </button>
        </mat-menu>

        <mat-menu #exportSingleOptions="matMenu" xPosition="before">
          <button mat-menu-item class="action-button" (click) = "exportValuation(transferStepperthree?.formOneAndThreeData?.company, 'pdf', 'FCFE', (transferStepperthree?.formFourData?.appData?.reportId || null))">
            <span style="width: 160px;display: block;text-align: left;padding-left: 9%;" class="resume-label">
              <img style="height: 13px;width: 13px;cursor: pointer;" src="../../../../../../assets/images/icons/pdf.png" alt="">
            <span style="font-size: 14px;padding-left: 9%;font-family: 'AR One Sans', sans-serif !important;">Export as PDF</span>
          </span>
          </button>
          <button mat-menu-item class="action-button" (click) = "exportValuation(transferStepperthree?.formOneAndThreeData?.company, 'docx', 'FCFE', (transferStepperthree?.formFourData?.appData?.reportId || null))">
            <span style="width: 160px;display: block;text-align: left;padding-left: 9%;" class="resume-label">
              <img style="height: 13px;width: 13px;cursor: pointer;" src="../../../../../../assets/images/icons/doc.png" alt="">
            <span style="font-size: 14px;padding-left: 9%;font-family: 'AR One Sans', sans-serif !important;">Export as Docx</span>
          </span>
          </button>
          <button mat-menu-item class="action-button" (click) = "exportValuation(transferStepperthree?.formOneAndThreeData?.company, 'xlsx', 'FCFE', (transferStepperthree?.formFourData?.appData?.reportId || null))">
            <span style="width: 160px;display: block;text-align: left;padding-left: 9%;" class="download-label">
              <img style="height: 13px;width: 13px;cursor: pointer;" src="../../../../../../assets/images/icons/xls.png" alt="">
            <span style="font-size: 14px;padding-left: 9%;font-family: 'AR One Sans', sans-serif !important;">Export as Excel</span>
          </span>
          </button>
        </mat-menu>
      </div>
    </div>
    <div>
      <div class="table-container" style="position: relative;">
        <div class="dcf-loader-overlay" *ngIf="dcfLoader">
          <div class="dcf-loader-container">
            <div class="dcf-loader">
              <div class="dcf-spinner"></div>
            </div>
          </div>
        </div>
        <!-- fcfe table starts -->
      <div class="scroll-container">
        <table [ngClass]="contentIsBig(dataSourceFcfe) ? 'increase-table-width' : ''" #dynamicTable>
          <thead>
            <tr style="text-transform: capitalize;" class="header">
              <th *ngFor="let columnName of fcfeColumn" [ngClass]="columnName === 'particulars' ?  contentIsBig(dataSourceFcfe) ? 'sticky-header' : '' : ''">{{ columnName }}</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let row of dataSourceFcfe;let i = index" class="content">
              <td style="text-align: center;font-size: 14px;text-transform: capitalize;" [ngClass]="checkVal(cellValue,'fcfe') ? contentIsBig(dataSourceFcfe) ?  (i % 2 === 0  ? 'make-bold line-item-even' : 'make-light line-item-odd')  : 'make-light': 'make-light'" *ngFor="let cellValue of row">{{isDiscountingFactor(row) ?  formatNumber(cellValue, true) : formatNumber(cellValue)}}</td>
            </tr>
          </tbody>
        </table>
      </div>
      <!-- fcfe table ends -->
      </div>
  </div>
  </mat-tab>
   <mat-tab label="FCFF" *ngIf = "fcff">
    <div style="display: flex; align-items: center; justify-content: space-between;padding: 1%;">
      <div style="display: flex; align-items: center;width: 85%;">
        <div style="display: inline-block; align-items: center;" [ngStyle]="getStyle('terminalWorkingContainer')">
          <input type="radio" id="tvCashFlow" name="radios" style="vertical-align: text-top;" [checked]="terminalValueSelectedType === 'tvCashFlowBased'" (click)="terminalValueOptions('tvCashFlowBased')">
          <label for="tvCashFlow" class="remove-bottom-margin terminal-working-options" style="padding-right: 4%;">
            Terminal Value based on last year Cash Flow
            <span class="tool-class" style="vertical-align: sub;">
              <svg [matTooltip]="helperText.tvCashFlowBased" matTooltipPosition="above" matTooltipClass='model-tooltip' xmlns="http://www.w3.org/2000/svg" width="17" height="17" viewBox="0 0 512 512">
                <path d="M248,64C146.39,64,64,146.39,64,248s82.39,184,184,184,184-82.39,184-184S349.61,64,248,64Z" class="path-svg" style="fill:none;stroke:#3355dd;stroke-miterlimit:10;stroke-width:37px" 
                fill="#ff0000"></path>
                <polyline points="220 220 252 220 252 336" class="model-polyline" style="fill:none;stroke:#3355dd;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px">
                </polyline><line x1="208" y1="340" x2="296" y2="340" style="fill:none;stroke:#3355dd;stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px">
              </line><path d="M248,130a26,26,0,1,0,26,26A26,26,0,0,0,248,130Z" fill="#ff0000"></path></svg>
            </span>
          </label>
          <input type="radio" id="tvLastYearPat" name="radios" style="vertical-align: text-top;" [checked]="terminalValueSelectedType === 'tvPatBased'" (click)="terminalValueOptions('tvPatBased')">
          <label for="tvLastYearPat" class="remove-bottom-margin terminal-working-options">
            Terminal Value based on last year PAT
            <span class="tool-class" style="vertical-align: sub;">
              <svg [matTooltip]="helperText.tvPatBased" matTooltipPosition="above" matTooltipClass='model-tooltip' xmlns="http://www.w3.org/2000/svg" width="17" height="17" viewBox="0 0 512 512">
                <path d="M248,64C146.39,64,64,146.39,64,248s82.39,184,184,184,184-82.39,184-184S349.61,64,248,64Z" class="path-svg" style="fill:none;stroke:#3355dd;stroke-miterlimit:10;stroke-width:37px" 
                fill="#ff0000"></path>
                <polyline points="220 220 252 220 252 336" class="model-polyline" style="fill:none;stroke:#3355dd;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px">
                </polyline><line x1="208" y1="340" x2="296" y2="340" style="fill:none;stroke:#3355dd;stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px">
              </line><path d="M248,130a26,26,0,1,0,26,26A26,26,0,0,0,248,130Z" fill="#ff0000"></path></svg>
            </span>
          </label>
        </div>
        <button mat-stroked-button class="terminal-working-button" style="color: white;" [ngStyle]="getStyle('terminalWorkingButton')" (click)="loadTerminalValueWorking()">
         View Terminal Working
        </button>
      </div> 
      <button mat-stroked-button class="terminal-working-button" style="width: 17%;color: white;margin-right: 2%;" (click)="sensitivityAnalysis('FCFF')" *ngIf="userAccess">
        Sensitivity Analysis
       </button>
      <div class="dropdown">
        <button class="dropdown-toggle" mat-stroked-button [matMenuTriggerFor]="fcffMenu" #trigger="matMenuTrigger" (mouseenter)="trigger.openMenu()">
          Export
        </button>
        <mat-menu #fcffMenu="matMenu" xPosition="before">
          <button mat-menu-item class="action-button" [matMenuTriggerFor]="exportSingleOptions">
            <span style="width: 190px;display: block;text-align: left;padding-left: 9%;" class="resume-label">
              <img style="height: 13px;width: 13px;cursor: pointer;" src="../../../../../../assets/images/icons/sheet.png" alt="">
            <span style="font-size: 14px;padding-left: 9%;font-family: 'AR One Sans', sans-serif !important;">Export Current</span>
          </span>
          </button>
          <button mat-menu-item class="action-button" [matMenuTriggerFor]="exportAllOptions" *ngIf="transferStepperthree?.formOneAndThreeData?.model?.length > 1">
            <span style="width: 190px;display: block;text-align: left;padding-left: 9%;" class="download-label">
              <img style="height: 13px;width: 13px;cursor: pointer;" src="../../../../../../assets/images/icons/document.png" alt="">
            <span style="font-size: 14px;padding-left: 9%;font-family: 'AR One Sans', sans-serif !important;">Export All</span>
          </span>
          </button>
        </mat-menu>

        <mat-menu #exportAllOptions="matMenu" xPosition="before">
          <button mat-menu-item class="action-button" (click) = "exportValuation(transferStepperthree?.formOneAndThreeData?.company, 'pdf', 'FCFF', (transferStepperthree?.formFourData?.appData?.reportId || null), false)">
            <span style="width: 160px;display: block;text-align: left;padding-left: 9%;" class="resume-label">
              <img style="height: 13px;width: 13px;cursor: pointer;" src="../../../../../../assets/images/icons/pdf.png" alt="">
            <span style="font-size: 14px;padding-left: 9%;font-family: 'AR One Sans', sans-serif !important;">Export as PDF</span>
          </span>
          </button>
          <button mat-menu-item class="action-button" (click) = "exportValuation(transferStepperthree?.formOneAndThreeData?.company, 'docx', 'FCFF', (transferStepperthree?.formFourData?.appData?.reportId || null), false)">
            <span style="width: 160px;display: block;text-align: left;padding-left: 9%;" class="resume-label">
              <img style="height: 13px;width: 13px;cursor: pointer;" src="../../../../../../assets/images/icons/doc.png" alt="">
            <span style="font-size: 14px;padding-left: 9%;font-family: 'AR One Sans', sans-serif !important;">Export as Docx</span>
          </span>
          </button>
          <button mat-menu-item class="action-button" (click) = "exportValuation(transferStepperthree?.formOneAndThreeData?.company, 'xlsx', 'FCFF', (transferStepperthree?.formFourData?.appData?.reportId || null), false)">
            <span style="width: 160px;display: block;text-align: left;padding-left: 9%;" class="download-label">
              <img style="height: 13px;width: 13px;cursor: pointer;" src="../../../../../../assets/images/icons/xls.png" alt="">
            <span style="font-size: 14px;padding-left: 9%;font-family: 'AR One Sans', sans-serif !important;">Export as Excel</span>
          </span>
          </button>
        </mat-menu>

        <mat-menu #exportSingleOptions="matMenu" xPosition="before">
          <button mat-menu-item class="action-button" (click) = "exportValuation(transferStepperthree?.formOneAndThreeData?.company, 'pdf', 'FCFF', (transferStepperthree?.formFourData?.appData?.reportId || null))">
            <span style="width: 160px;display: block;text-align: left;padding-left: 9%;" class="resume-label">
              <img style="height: 13px;width: 13px;cursor: pointer;" src="../../../../../../assets/images/icons/pdf.png" alt="">
            <span style="font-size: 14px;padding-left: 9%;font-family: 'AR One Sans', sans-serif !important;">Export as PDF</span>
          </span>
          </button>
          <button mat-menu-item class="action-button" (click) = "exportValuation(transferStepperthree?.formOneAndThreeData?.company, 'docx', 'FCFF', (transferStepperthree?.formFourData?.appData?.reportId || null))">
            <span style="width: 160px;display: block;text-align: left;padding-left: 9%;" class="resume-label">
              <img style="height: 13px;width: 13px;cursor: pointer;" src="../../../../../../assets/images/icons/doc.png" alt="">
            <span style="font-size: 14px;padding-left: 9%;font-family: 'AR One Sans', sans-serif !important;">Export as Docx</span>
          </span>
          </button>
          <button mat-menu-item class="action-button" (click) = "exportValuation(transferStepperthree?.formOneAndThreeData?.company, 'xlsx', 'FCFF', (transferStepperthree?.formFourData?.appData?.reportId || null))">
            <span style="width: 160px;display: block;text-align: left;padding-left: 9%;" class="download-label">
              <img style="height: 13px;width: 13px;cursor: pointer;" src="../../../../../../assets/images/icons/xls.png" alt="">
            <span style="font-size: 14px;padding-left: 9%;font-family: 'AR One Sans', sans-serif !important;">Export as Excel</span>
          </span>
          </button>
        </mat-menu>

      </div>
    </div>
    <div>
      <!-- <h5 class="company-head-fcff">FCFF Result</h5> -->
      <div class="table-container" #dynamicTable style="position: relative;">
          <div class="dcf-loader-overlay" *ngIf="dcfLoader">
            <div class="dcf-loader-container">
              <div class="dcf-loader">
                <div class="dcf-spinner"></div>
              </div>
            </div>
          </div>
        <!-- table fcff  starts -->
        <table [ngClass]="contentIsBig(dataSourceFcff) ? 'increase-table-width' : ''">
          <thead>
            <tr style="text-transform: capitalize;" class="header">
              <th *ngFor="let columnName of fcffColumn" [ngClass]="columnName === 'particulars' ?  contentIsBig(dataSourceFcff) ? 'sticky-header' : '' : ''">{{ columnName }}</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let row of dataSourceFcff;let i = index" class="content">
              <td style="text-align: center;font-size: 14px;text-transform: capitalize;" [ngClass]="checkVal(cellValue,'fcff') ? contentIsBig(dataSourceFcff) ?  (i % 2 === 0  ? 'make-bold line-item-even' : 'make-light line-item-odd')  : 'make-light' : 'make-light'" *ngFor="let cellValue of row">{{ isDiscountingFactor(row) ?  formatNumber(cellValue, true) : formatNumber(cellValue) }}</td>
            </tr>
          </tbody>
        </table>
        <!-- table fcff  ends -->
      </div>
    </div>
  </mat-tab>
  <mat-tab label="Excess Earning" *ngIf = "excessEarn">
    <div class="dropdown" style="float: right;padding: 1%;">
      <button class="dropdown-toggle" mat-stroked-button [matMenuTriggerFor]="excessEarningMenu" #trigger="matMenuTrigger" (mouseenter)="trigger.openMenu()">
        Export
      </button>
      <mat-menu #excessEarningMenu="matMenu" xPosition="before">
        <button mat-menu-item class="action-button" [matMenuTriggerFor]="exportSingleOptions">
          <span style="width: 190px;display: block;text-align: left;padding-left: 9%;" class="resume-label">
            <img style="height: 13px;width: 13px;cursor: pointer;" src="../../../../../../assets/images/icons/sheet.png" alt="">
          <span style="font-size: 14px;padding-left: 9%;font-family: 'AR One Sans', sans-serif !important;">Export Current</span>
        </span>
        </button>
        <button mat-menu-item class="action-button" [matMenuTriggerFor]="exportAllOptions" *ngIf="transferStepperthree?.formOneAndThreeData?.model?.length > 1">
          <span style="width: 190px;display: block;text-align: left;padding-left: 9%;" class="download-label">
            <img style="height: 13px;width: 13px;cursor: pointer;" src="../../../../../../assets/images/icons/document.png" alt="">
          <span style="font-size: 14px;padding-left: 9%;font-family: 'AR One Sans', sans-serif !important;">Export All</span>
        </span>
        </button>
      </mat-menu>

      <mat-menu #exportAllOptions="matMenu" xPosition="before">
        <button mat-menu-item class="action-button" (click) = "exportValuation(transferStepperthree?.formOneAndThreeData?.company, 'pdf', 'Excess_Earnings', (transferStepperthree?.formFourData?.appData?.reportId || null), false)">
          <span style="width: 160px;display: block;text-align: left;padding-left: 9%;" class="resume-label">
            <img style="height: 13px;width: 13px;cursor: pointer;" src="../../../../../../assets/images/icons/pdf.png" alt="">
          <span style="font-size: 14px;padding-left: 9%;font-family: 'AR One Sans', sans-serif !important;">Export as PDF</span>
        </span>
        </button>
        <button mat-menu-item class="action-button" (click) = "exportValuation(transferStepperthree?.formOneAndThreeData?.company, 'docx', 'Excess_Earnings', (transferStepperthree?.formFourData?.appData?.reportId || null), false)">
          <span style="width: 160px;display: block;text-align: left;padding-left: 9%;" class="resume-label">
            <img style="height: 13px;width: 13px;cursor: pointer;" src="../../../../../../assets/images/icons/doc.png" alt="">
          <span style="font-size: 14px;padding-left: 9%;font-family: 'AR One Sans', sans-serif !important;">Export as Docx</span>
        </span>
        </button>
        <button mat-menu-item class="action-button" (click) = "exportValuation(transferStepperthree?.formOneAndThreeData?.company, 'xlsx', 'Excess_Earnings', (transferStepperthree?.formFourData?.appData?.reportId || null), false)">
          <span style="width: 160px;display: block;text-align: left;padding-left: 9%;" class="download-label">
            <img style="height: 13px;width: 13px;cursor: pointer;" src="../../../../../../assets/images/icons/xls.png" alt="">
          <span style="font-size: 14px;padding-left: 9%;font-family: 'AR One Sans', sans-serif !important;">Export as Excel</span>
        </span>
        </button>
      </mat-menu>

      <mat-menu #exportSingleOptions="matMenu" xPosition="before">
        <button mat-menu-item class="action-button" (click) = "exportValuation(transferStepperthree?.formOneAndThreeData?.company, 'pdf', 'Excess_Earnings', (transferStepperthree?.formFourData?.appData?.reportId || null))">
          <span style="width: 160px;display: block;text-align: left;padding-left: 9%;" class="resume-label">
            <img style="height: 13px;width: 13px;cursor: pointer;" src="../../../../../../assets/images/icons/pdf.png" alt="">
          <span style="font-size: 14px;padding-left: 9%;font-family: 'AR One Sans', sans-serif !important;">Export as PDF</span>
        </span>
        </button>
        <button mat-menu-item class="action-button" (click) = "exportValuation(transferStepperthree?.formOneAndThreeData?.company, 'docx', 'Excess_Earnings', (transferStepperthree?.formFourData?.appData?.reportId || null))">
          <span style="width: 160px;display: block;text-align: left;padding-left: 9%;" class="resume-label">
            <img style="height: 13px;width: 13px;cursor: pointer;" src="../../../../../../assets/images/icons/doc.png" alt="">
          <span style="font-size: 14px;padding-left: 9%;font-family: 'AR One Sans', sans-serif !important;">Export as Docx</span>
        </span>
        </button>
        <button mat-menu-item class="action-button" (click) = "exportValuation(transferStepperthree?.formOneAndThreeData?.company, 'xlsx', 'Excess_Earnings', (transferStepperthree?.formFourData?.appData?.reportId || null))">
          <span style="width: 160px;display: block;text-align: left;padding-left: 9%;" class="download-label">
            <img style="height: 13px;width: 13px;cursor: pointer;" src="../../../../../../assets/images/icons/xls.png" alt="">
          <span style="font-size: 14px;padding-left: 9%;font-family: 'AR One Sans', sans-serif !important;">Export as Excel</span>
        </span>
        </button>
      </mat-menu>
    </div>
    <div>
      <h5 class="company-head-excEarn">Excess Earning Result</h5>
      <div class="table-container">
        <!-- excess earning table starts -->
      <table>
        <thead>
          <tr style="text-transform: capitalize;" class="header">
            <th *ngFor="let columnName of excessEarnColumn">{{ columnName }}</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let row of dataSourceExcessEarn" class="content">
            <td style="text-align: center;font-size: 14px;text-transform: capitalize;" [ngClass]="checkVal(cellValue,'Excess_Earnings') ? 'make-bold' : 'make-light'" *ngFor="let cellValue of row">{{ isDiscountingFactor(row) ?  formatNumber(cellValue, true) : formatNumber(cellValue) }}</td>
          </tr>
        </tbody>
      </table>
      <!-- excess earning table ends -->
      </div>
  </div>
  </mat-tab> 
  <mat-tab [label]="checkIndustryOrCompany() ? 'Comparable Companies' : 'Comparable Transaction'" *ngIf="relativeVal">
    <div style="display: flex; align-items: center; justify-content: space-between;padding: 1%;">
    <div style="display: flex; align-items: center;width: 85%;">
      <div style="display: inline-block; align-items: center;width: 100%;">
        <input type="radio" id="tvCashFlow" name="radios" style="vertical-align: middle;" [checked]="ccmValuationMetric === 'average'" (click)="ccmMetric('average')">
        <label for="tvCashFlow" class="remove-bottom-margin terminal-working-options" style="padding-right: 4%;">
          Value per share using Average
          <span class="tool-class" style="vertical-align: sub;">
            <svg [matTooltip]="helperText.averageCCM" matTooltipPosition="above" matTooltipClass='model-tooltip' xmlns="http://www.w3.org/2000/svg" width="17" height="17" viewBox="0 0 512 512">
              <path d="M248,64C146.39,64,64,146.39,64,248s82.39,184,184,184,184-82.39,184-184S349.61,64,248,64Z" class="path-svg" style="fill:none;stroke:#3355dd;stroke-miterlimit:10;stroke-width:37px" 
              fill="#ff0000"></path>
              <polyline points="220 220 252 220 252 336" class="model-polyline" style="fill:none;stroke:#3355dd;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px">
              </polyline><line x1="208" y1="340" x2="296" y2="340" style="fill:none;stroke:#3355dd;stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px">
            </line><path d="M248,130a26,26,0,1,0,26,26A26,26,0,0,0,248,130Z" fill="#ff0000"></path></svg>
          </span>
        </label>
        <input type="radio" id="tvLastYearPat" name="radios" style="vertical-align: middle;" [checked]="ccmValuationMetric === 'median'" (click)="ccmMetric('median')">
        <label for="tvLastYearPat" class="remove-bottom-margin terminal-working-options">
          Value per share using Median
          <span class="tool-class" style="vertical-align: sub;">
            <svg [matTooltip]="helperText.medianCCM" matTooltipPosition="above" matTooltipClass='model-tooltip' xmlns="http://www.w3.org/2000/svg" width="17" height="17" viewBox="0 0 512 512">
              <path d="M248,64C146.39,64,64,146.39,64,248s82.39,184,184,184,184-82.39,184-184S349.61,64,248,64Z" class="path-svg" style="fill:none;stroke:#3355dd;stroke-miterlimit:10;stroke-width:37px" 
              fill="#ff0000"></path>
              <polyline points="220 220 252 220 252 336" class="model-polyline" style="fill:none;stroke:#3355dd;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px">
              </polyline><line x1="208" y1="340" x2="296" y2="340" style="fill:none;stroke:#3355dd;stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px">
            </line><path d="M248,130a26,26,0,1,0,26,26A26,26,0,0,0,248,130Z" fill="#ff0000"></path></svg>
          </span>
        </label>
      </div>
    </div>
    <div class="dropdown" style="float: right;padding: 1%;" >
      <button class="dropdown-toggle" mat-stroked-button [matMenuTriggerFor]="relativeValuationMenu" #trigger="matMenuTrigger" (mouseenter)="trigger.openMenu()">
        Export
      </button>
      <mat-menu #relativeValuationMenu="matMenu" xPosition="before">
        <button mat-menu-item class="action-button" [matMenuTriggerFor]="exportSingleOptions">
          <span style="width: 190px;display: block;text-align: left;padding-left: 9%;" class="resume-label">
            <img style="height: 13px;width: 13px;cursor: pointer;" src="../../../../../../assets/images/icons/sheet.png" alt="">
          <span style="font-size: 14px;padding-left: 9%;font-family: 'AR One Sans', sans-serif !important;">Export Current</span>
        </span>
        </button>
        <button mat-menu-item class="action-button" [matMenuTriggerFor]="exportAllOptions" *ngIf="transferStepperthree?.formOneAndThreeData?.model?.length > 1">
          <span style="width: 190px;display: block;text-align: left;padding-left: 9%;" class="download-label">
            <img style="height: 13px;width: 13px;cursor: pointer;" src="../../../../../../assets/images/icons/document.png" alt="">
          <span style="font-size: 14px;padding-left: 9%;font-family: 'AR One Sans', sans-serif !important;">Export All</span>
        </span>
        </button>
      </mat-menu>

      <mat-menu #exportAllOptions="matMenu" xPosition="before">
        <button mat-menu-item class="action-button" (click) = "exportValuation(transferStepperthree?.formOneAndThreeData?.company, 'pdf', 'Relative_Valuation', (transferStepperthree?.formFourData?.appData?.reportId || null), false)">
          <span style="width: 160px;display: block;text-align: left;padding-left: 9%;" class="resume-label">
            <img style="height: 13px;width: 13px;cursor: pointer;" src="../../../../../../assets/images/icons/pdf.png" alt="">
          <span style="font-size: 14px;padding-left: 9%;font-family: 'AR One Sans', sans-serif !important;">Export as PDF</span>
        </span>
        </button>
        <button mat-menu-item class="action-button" (click) = "exportValuation(transferStepperthree?.formOneAndThreeData?.company, 'docx', 'Relative_Valuation', (transferStepperthree?.formFourData?.appData?.reportId || null), false)">
          <span style="width: 160px;display: block;text-align: left;padding-left: 9%;" class="resume-label">
            <img style="height: 13px;width: 13px;cursor: pointer;" src="../../../../../../assets/images/icons/doc.png" alt="">
          <span style="font-size: 14px;padding-left: 9%;font-family: 'AR One Sans', sans-serif !important;">Export as Docx</span>
        </span>
        </button>
        <button mat-menu-item class="action-button" (click) = "exportValuation(transferStepperthree?.formOneAndThreeData?.company, 'xlsx', 'Relative_Valuation', (transferStepperthree?.formFourData?.appData?.reportId || null), false)">
          <span style="width: 160px;display: block;text-align: left;padding-left: 9%;" class="download-label">
            <img style="height: 13px;width: 13px;cursor: pointer;" src="../../../../../../assets/images/icons/xls.png" alt="">
          <span style="font-size: 14px;padding-left: 9%;font-family: 'AR One Sans', sans-serif !important;">Export as Excel</span>
        </span>
        </button>
      </mat-menu>

      <mat-menu #exportSingleOptions="matMenu" xPosition="before">
        <button mat-menu-item class="action-button" (click) = "exportValuation(transferStepperthree?.formOneAndThreeData?.company, 'pdf', 'Relative_Valuation', (transferStepperthree?.formFourData?.appData?.reportId || null))">
          <span style="width: 160px;display: block;text-align: left;padding-left: 9%;" class="resume-label">
            <img style="height: 13px;width: 13px;cursor: pointer;" src="../../../../../../assets/images/icons/pdf.png" alt="">
          <span style="font-size: 14px;padding-left: 9%;font-family: 'AR One Sans', sans-serif !important;">Export as PDF</span>
        </span>
        </button>
        <button mat-menu-item class="action-button" (click) = "exportValuation(transferStepperthree?.formOneAndThreeData?.company, 'docx', 'Relative_Valuation', (transferStepperthree?.formFourData?.appData?.reportId || null))">
          <span style="width: 160px;display: block;text-align: left;padding-left: 9%;" class="resume-label">
            <img style="height: 13px;width: 13px;cursor: pointer;" src="../../../../../../assets/images/icons/doc.png" alt="">
          <span style="font-size: 14px;padding-left: 9%;font-family: 'AR One Sans', sans-serif !important;">Export as Docx</span>
        </span>
        </button>
        <button mat-menu-item class="action-button" (click) = "exportValuation(transferStepperthree?.formOneAndThreeData?.company, 'xlsx', 'Relative_Valuation', (transferStepperthree?.formFourData?.appData?.reportId || null))">
          <span style="width: 160px;display: block;text-align: left;padding-left: 9%;" class="download-label">
            <img style="height: 13px;width: 13px;cursor: pointer;" src="../../../../../../assets/images/icons/xls.png" alt="">
          <span style="font-size: 14px;padding-left: 9%;font-family: 'AR One Sans', sans-serif !important;">Export as Excel</span>
        </span>
        </button>
      </mat-menu>
    </div>
  </div>
    <div>
        <!-- <h5 class="company-head-relativeval">Relative Valuations Result</h5> -->
        <div class="table-container" style="display: block;position: relative;">
        <app-relative-valuations-table [tableData]="tableData" [formData]="formData" [ccmValuationMetric]="ccmValuationMetric" [multiples]="multiples" (recalculateCcmValuation)="recalculateCcmValuation($event)"></app-relative-valuations-table>
          <div class="mt-4">
            <app-model-relative-valuation-result-table [dataSource]="valuationDataReport" [formData]="formData" [ccmValuationMetric]="ccmValuationMetric"></app-model-relative-valuation-result-table>
            <div class="dcf-loader-overlay" *ngIf="ccmCompanyTableLoader">
            </div>
          </div>
      </div>
    </div>  
  </mat-tab>
  <mat-tab label="Net Asset Value" *ngIf="nav">
    <div class="dropdown" style="float: right;padding: 1%;">
      <button class="dropdown-toggle" mat-stroked-button [matMenuTriggerFor]="navMenu" #trigger="matMenuTrigger" (mouseenter)="trigger.openMenu()">
        Export
      </button>
      <mat-menu #navMenu="matMenu" xPosition="before">
        <button mat-menu-item class="action-button" [matMenuTriggerFor]="exportSingleOptions">
          <span style="width: 190px;display: block;text-align: left;padding-left: 9%;" class="resume-label">
            <img style="height: 13px;width: 13px;cursor: pointer;" src="../../../../../../assets/images/icons/sheet.png" alt="">
          <span style="font-size: 14px;padding-left: 9%;font-family: 'AR One Sans', sans-serif !important;">Export Current</span>
        </span>
        </button>
        <button mat-menu-item class="action-button" [matMenuTriggerFor]="exportAllOptions" *ngIf="transferStepperthree?.formOneAndThreeData?.model?.length > 1">
          <span style="width: 190px;display: block;text-align: left;padding-left: 9%;" class="download-label">
            <img style="height: 13px;width: 13px;cursor: pointer;" src="../../../../../../assets/images/icons/document.png" alt="">
          <span style="font-size: 14px;padding-left: 9%;font-family: 'AR One Sans', sans-serif !important;">Export All</span>
        </span>
        </button>
      </mat-menu>

      <mat-menu #exportAllOptions="matMenu" xPosition="before">
        <button mat-menu-item class="action-button" (click) = "exportValuation(transferStepperthree?.formOneAndThreeData?.company, 'pdf', 'NAV', (transferStepperthree?.formFourData?.appData?.reportId || null), false)">
          <span style="width: 160px;display: block;text-align: left;padding-left: 9%;" class="resume-label">
            <img style="height: 13px;width: 13px;cursor: pointer;" src="../../../../../../assets/images/icons/pdf.png" alt="">
          <span style="font-size: 14px;padding-left: 9%;font-family: 'AR One Sans', sans-serif !important;">Export as PDF</span>
        </span>
        </button>
        <button mat-menu-item class="action-button" (click) = "exportValuation(transferStepperthree?.formOneAndThreeData?.company, 'docx', 'NAV', (transferStepperthree?.formFourData?.appData?.reportId || null), false)">
          <span style="width: 160px;display: block;text-align: left;padding-left: 9%;" class="resume-label">
            <img style="height: 13px;width: 13px;cursor: pointer;" src="../../../../../../assets/images/icons/doc.png" alt="">
          <span style="font-size: 14px;padding-left: 9%;font-family: 'AR One Sans', sans-serif !important;">Export as Docx</span>
        </span>
        </button>
        <button mat-menu-item class="action-button" (click) = "exportValuation(transferStepperthree?.formOneAndThreeData?.company, 'xlsx', 'NAV', (transferStepperthree?.formFourData?.appData?.reportId || null), false)">
          <span style="width: 160px;display: block;text-align: left;padding-left: 9%;" class="download-label">
            <img style="height: 13px;width: 13px;cursor: pointer;" src="../../../../../../assets/images/icons/xls.png" alt="">
          <span style="font-size: 14px;padding-left: 9%;font-family: 'AR One Sans', sans-serif !important;">Export as Excel</span>
        </span>
        </button>
      </mat-menu>

      <mat-menu #exportSingleOptions="matMenu" xPosition="before">
        <button mat-menu-item class="action-button" (click) = "exportValuation(transferStepperthree?.formOneAndThreeData?.company, 'pdf', 'NAV', (transferStepperthree?.formFourData?.appData?.reportId || null))">
          <span style="width: 160px;display: block;text-align: left;padding-left: 9%;" class="resume-label">
            <img style="height: 13px;width: 13px;cursor: pointer;" src="../../../../../../assets/images/icons/pdf.png" alt="">
          <span style="font-size: 14px;padding-left: 9%;font-family: 'AR One Sans', sans-serif !important;">Export as PDF</span>
        </span>
        </button>
        <button mat-menu-item class="action-button" (click) = "exportValuation(transferStepperthree?.formOneAndThreeData?.company, 'docx', 'NAV', (transferStepperthree?.formFourData?.appData?.reportId || null))">
          <span style="width: 160px;display: block;text-align: left;padding-left: 9%;" class="resume-label">
            <img style="height: 13px;width: 13px;cursor: pointer;" src="../../../../../../assets/images/icons/doc.png" alt="">
          <span style="font-size: 14px;padding-left: 9%;font-family: 'AR One Sans', sans-serif !important;">Export as Docx</span>
        </span>
        </button>
        <button mat-menu-item class="action-button" (click) = "exportValuation(transferStepperthree?.formOneAndThreeData?.company, 'xlsx', 'NAV', (transferStepperthree?.formFourData?.appData?.reportId || null))">
          <span style="width: 160px;display: block;text-align: left;padding-left: 9%;" class="download-label">
            <img style="height: 13px;width: 13px;cursor: pointer;" src="../../../../../../assets/images/icons/xls.png" alt="">
          <span style="font-size: 14px;padding-left: 9%;font-family: 'AR One Sans', sans-serif !important;">Export as Excel</span>
        </span>
        </button>
      </mat-menu>
    </div>
    <div>
      <!-- <h5 class="head-nav">NAV Result</h5> -->
      <div class="table-container">
        <table>
          <thead>
            <tr class="header">
              <th style="padding-left: 4%;">Particulars</th>
              <!-- <th>Type</th> -->
              <th >Book Value</th>
              <th >Fair Value</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let item of dataSourceNav" [ngClass]="keyValidator(item, 'mainHead') ? 'nav-style-main-header' : keyValidator(item, 'mainSubHead') ? 'nav-style-main-sub-header' : keyValidator(item, 'header') ? 'nav-style-header' : 'nav-style-sub-header'">
              <td [ngClass]="keyValidator(item, 'subHeader') ? 'nav-add-pad-left' : keyValidator(item, 'nestedSubHeader') ? 'nav-add-nested-pad-left' : 'nav-style-sub-header'">{{ item.fieldName }}</td>
              <td style="width: 20%;padding-left:2%">{{ formatNumber(item.bookValue)  }}</td>
              <td style="width: 20%;padding-left:2%">{{ formatNumber(item.fairValue)  }}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </mat-tab>
  <mat-tab label="Berkus" *ngIf="berkus">
    <div class="table-container" style="display: block;">
      <app-berkus-valuation></app-berkus-valuation>
    </div>
  </mat-tab>
  <mat-tab label="Risk Factor" *ngIf="riskFactor">
    <div class="table-container" style="display: block;">
      <app-risk-factor-valuation></app-risk-factor-valuation>
    </div>
  </mat-tab>
  <mat-tab label="Score Card" *ngIf="scoreCard">
    <div class="table-container" style="display: block;">
      <app-score-card-valuation></app-score-card-valuation>
    </div>
  </mat-tab>
  <mat-tab label="Venture Capital" *ngIf="ventureCapital">
    <div class="table-container" style="display: block;">
      <app-venture-capital-valuation></app-venture-capital-valuation>
    </div>
  </mat-tab>
  <mat-tab label="Rule 11 UA" *ngIf="ruleElevenUa">
    <!-- <div class="btn" style="text-align: right;width: 100%;">
      <button mat-stroked-button class="exp">
        <a class="exp-a" [href]="HOST + 'upload/export-eleven-ua/' + (transferStepperthree?.formFourData?.appData?._id || 'null')" download>Export</a>
      </button>
    </div> -->
    <div class="dropdown" style="float: right;padding: 1%;" (mouseenter)="isDropdownOpen = true" (mouseleave)="isDropdownOpen = false">
      <button class="dropdown-toggle" mat-stroked-button >
        Export
      </button>
      <div class="dropdown-menu" [ngClass]="{ 'show': isDropdownOpen }">
        <button class="dropdown-item"><a (click) = "exportValuation(transferStepperthree?.formOneAndThreeData?.company, 'pdf', 'ruleElevenUa', (transferStepperthree?.formFourData?.appData?._id || null))">Export as PDF</a></button>
        <button class="dropdown-item"><a (click) = "exportValuation(transferStepperthree?.formOneAndThreeData?.company, 'docx', 'ruleElevenUa', (transferStepperthree?.formFourData?.appData?._id || null))">Export as Docx</a></button>
        <button class="dropdown-item"><a (click) = "exportValuation(transferStepperthree?.formOneAndThreeData?.company, 'xlsx', 'ruleElevenUa', (transferStepperthree?.formFourData?.appData?._id || null))">Export as Excel</a></button>
      </div>
    </div>
    <div>
      <div class="table-container" style="display: block;">
        <app-model-rule-eleven-ua-result-table [formData]="transferStepperthree"></app-model-rule-eleven-ua-result-table>
      </div>
    </div>
  </mat-tab>
  <mat-tab label="Market Price" *ngIf="marketPrice">
    <div style="display: flex; align-items: center; justify-content: space-between;padding: 1%;">
      <div style="display: flex; align-items: center;width: 85%;">
        <div style="display: inline-block; align-items: center;width: 100%;" *ngIf="containsNseAndBse()">
          <input type="radio" id="tvCashFlow" name="radios" style="vertical-align: middle;" [checked]="marketMethodType === 'vwapNse'" (click)="marketPriceType('vwapNse')">
          <label for="tvCashFlow" class="remove-bottom-margin terminal-working-options" style="padding-right: 4%;">
            Volume Weighted Average Price(VWAP) using NSE
            <span class="tool-class" style="vertical-align: sub;">
              <svg [matTooltip]="helperText.vwapNse" matTooltipPosition="above" matTooltipClass='model-tooltip' xmlns="http://www.w3.org/2000/svg" width="17" height="17" viewBox="0 0 512 512">
                <path d="M248,64C146.39,64,64,146.39,64,248s82.39,184,184,184,184-82.39,184-184S349.61,64,248,64Z" class="path-svg" style="fill:none;stroke:#3355dd;stroke-miterlimit:10;stroke-width:37px" 
                fill="#ff0000"></path>
                <polyline points="220 220 252 220 252 336" class="model-polyline" style="fill:none;stroke:#3355dd;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px">
                </polyline><line x1="208" y1="340" x2="296" y2="340" style="fill:none;stroke:#3355dd;stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px">
              </line><path d="M248,130a26,26,0,1,0,26,26A26,26,0,0,0,248,130Z" fill="#ff0000"></path></svg>
            </span>
          </label>
          <input type="radio" id="tvLastYearPat" name="radios" style="vertical-align: middle;" [checked]="marketMethodType === 'vwapBse'" (click)="marketPriceType('vwapBse')">
          <label for="tvLastYearPat" class="remove-bottom-margin terminal-working-options">
            Volume Weighted Average Price(VWAP) using BSE
            <span class="tool-class" style="vertical-align: sub;">
              <svg [matTooltip]="helperText.vwapBse" matTooltipPosition="above" matTooltipClass='model-tooltip' xmlns="http://www.w3.org/2000/svg" width="17" height="17" viewBox="0 0 512 512">
                <path d="M248,64C146.39,64,64,146.39,64,248s82.39,184,184,184,184-82.39,184-184S349.61,64,248,64Z" class="path-svg" style="fill:none;stroke:#3355dd;stroke-miterlimit:10;stroke-width:37px" 
                fill="#ff0000"></path>
                <polyline points="220 220 252 220 252 336" class="model-polyline" style="fill:none;stroke:#3355dd;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px">
                </polyline><line x1="208" y1="340" x2="296" y2="340" style="fill:none;stroke:#3355dd;stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px">
              </line><path d="M248,130a26,26,0,1,0,26,26A26,26,0,0,0,248,130Z" fill="#ff0000"></path></svg>
            </span>
          </label>
        </div>
      </div>
      <div class="dropdown" style="float: right;padding: 1%;">
        <button class="dropdown-toggle" mat-stroked-button [matMenuTriggerFor]="marketPriceMenu" #trigger="matMenuTrigger" (mouseenter)="trigger.openMenu()">
          Export
        </button>
        <mat-menu #marketPriceMenu="matMenu" xPosition="before">
          <button mat-menu-item class="action-button" [matMenuTriggerFor]="exportSingleOptions">
            <span style="width: 190px;display: block;text-align: left;padding-left: 9%;" class="resume-label">
              <img style="height: 13px;width: 13px;cursor: pointer;" src="../../../../../../assets/images/icons/sheet.png" alt="">
            <span style="font-size: 14px;padding-left: 9%;font-family: 'AR One Sans', sans-serif !important;">Export Current</span>
          </span>
          </button>
          <button mat-menu-item class="action-button" [matMenuTriggerFor]="exportAllOptions" *ngIf="transferStepperthree?.formOneAndThreeData?.model?.length > 1">
            <span style="width: 190px;display: block;text-align: left;padding-left: 9%;" class="download-label">
              <img style="height: 13px;width: 13px;cursor: pointer;" src="../../../../../../assets/images/icons/document.png" alt="">
            <span style="font-size: 14px;padding-left: 9%;font-family: 'AR One Sans', sans-serif !important;">Export All</span>
          </span>
          </button>
        </mat-menu>
  
        <mat-menu #exportAllOptions="matMenu" xPosition="before">
          <button mat-menu-item class="action-button" (click) = "exportValuation(transferStepperthree?.formOneAndThreeData?.company, 'pdf', 'Market_Price', (transferStepperthree?.formFourData?.appData?.reportId || null), false)">
            <span style="width: 160px;display: block;text-align: left;padding-left: 9%;" class="resume-label">
              <img style="height: 13px;width: 13px;cursor: pointer;" src="../../../../../../assets/images/icons/pdf.png" alt="">
            <span style="font-size: 14px;padding-left: 9%;font-family: 'AR One Sans', sans-serif !important;">Export as PDF</span>
          </span>
          </button>
          <button mat-menu-item class="action-button" (click) = "exportValuation(transferStepperthree?.formOneAndThreeData?.company, 'docx', 'Market_Price', (transferStepperthree?.formFourData?.appData?.reportId || null), false)">
            <span style="width: 160px;display: block;text-align: left;padding-left: 9%;" class="resume-label">
              <img style="height: 13px;width: 13px;cursor: pointer;" src="../../../../../../assets/images/icons/doc.png" alt="">
            <span style="font-size: 14px;padding-left: 9%;font-family: 'AR One Sans', sans-serif !important;">Export as Docx</span>
          </span>
          </button>
          <button mat-menu-item class="action-button" (click) = "exportValuation(transferStepperthree?.formOneAndThreeData?.company, 'xlsx', 'Market_Price', (transferStepperthree?.formFourData?.appData?.reportId || null), false)">
            <span style="width: 160px;display: block;text-align: left;padding-left: 9%;" class="download-label">
              <img style="height: 13px;width: 13px;cursor: pointer;" src="../../../../../../assets/images/icons/xls.png" alt="">
            <span style="font-size: 14px;padding-left: 9%;font-family: 'AR One Sans', sans-serif !important;">Export as Excel</span>
          </span>
          </button>
        </mat-menu>
  
        <mat-menu #exportSingleOptions="matMenu" xPosition="before">
          <button mat-menu-item class="action-button" (click) = "exportValuation(transferStepperthree?.formOneAndThreeData?.company, 'pdf', 'Market_Price', (transferStepperthree?.formFourData?.appData?.reportId || null))">
            <span style="width: 160px;display: block;text-align: left;padding-left: 9%;" class="resume-label">
              <img style="height: 13px;width: 13px;cursor: pointer;" src="../../../../../../assets/images/icons/pdf.png" alt="">
            <span style="font-size: 14px;padding-left: 9%;font-family: 'AR One Sans', sans-serif !important;">Export as PDF</span>
          </span>
          </button>
          <button mat-menu-item class="action-button" (click) = "exportValuation(transferStepperthree?.formOneAndThreeData?.company, 'docx', 'Market_Price', (transferStepperthree?.formFourData?.appData?.reportId || null))">
            <span style="width: 160px;display: block;text-align: left;padding-left: 9%;" class="resume-label">
              <img style="height: 13px;width: 13px;cursor: pointer;" src="../../../../../../assets/images/icons/doc.png" alt="">
            <span style="font-size: 14px;padding-left: 9%;font-family: 'AR One Sans', sans-serif !important;">Export as Docx</span>
          </span>
          </button>
          <button mat-menu-item class="action-button" (click) = "exportValuation(transferStepperthree?.formOneAndThreeData?.company, 'xlsx', 'Market_Price', (transferStepperthree?.formFourData?.appData?.reportId || null))">
            <span style="width: 160px;display: block;text-align: left;padding-left: 9%;" class="download-label">
              <img style="height: 13px;width: 13px;cursor: pointer;" src="../../../../../../assets/images/icons/xls.png" alt="">
            <span style="font-size: 14px;padding-left: 9%;font-family: 'AR One Sans', sans-serif !important;">Export as Excel</span>
          </span>
          </button>
        </mat-menu>
      </div>
    </div>
    <div>
      <div class="table-container" style="display: block;">
        <app-model-market-price-result-table [formData]="transferStepperthree" [marketMethodType]="marketMethodType" (marketPriceRevaluation)="marketPriceRevaluation($event)"></app-model-market-price-result-table>
      </div>
    </div>
  </mat-tab>
</mat-tab-group>
<p class="currency-unit" *ngIf="transferStepperthree?.formOneAndThreeData?.excelSheetId && !isOnlyMarketApproach()">Amount in {{transferStepperthree?.formOneAndThreeData?.currencyUnit}} 
  {{transferStepperthree?.formOneAndThreeData?.reportingUnit === 'absolute' ? '' : (transferStepperthree?.formOneAndThreeData?.reportingUnit)}}</p>
</div>
<!-- <div class="loader-overlay" *ngIf="isLoader">
  <div class="loader">
    <div class="loader-spinner"></div>
    <div class="loader-message">Please wait...</div>
  </div>
</div> -->
<div class="loader-overlay" *ngIf="isLoader">
</div>